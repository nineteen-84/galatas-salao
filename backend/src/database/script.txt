CREATE DATABASE galatas_database;

USE DATABASE galatas_database;

CREATE TABLE galatas_users (
    id INT PRIMARY KEY AUTO_INCREMENT,

    nome VARCHAR(80) NOT NULL,
    email VARCHAR(80) UNIQUE NOT NULL,
    senha VARCHAR(260) NOT NULL,

    telefone VARCHAR(20) NOT NULL,
    cpf VARCHAR(11) NOT NULL,

    role ENUM('assinante', 'admin', 'nao_assinante') NOT NULL
);

CREATE TABLE galatas_signature (
    id int PRIMARY KEY AUTO_INCREMENT,

    nome VARCHAR(120) NOT NULL,

    preco DECIMAL(10 , 2) NOT NULL,
    benefits VARCHAR(900) NOT NULL,
    duracao_dias ENUM('30', '90', '365') NOT NULL
);

CREATE TABLE galatas_barbers (
    id INT PRIMARY KEY AUTO_INCREMENT,

    nome VARCHAR(80) NOT NULL,

    telefone VARCHAR(20) NOT NULL,
    role ENUM('ativo', 'inativo') NOT NULL
);

CREATE TABLE galatas_services (
    id INT PRIMARY KEY AUTO_INCREMENT,

    nome VARCHAR(80) NOT NULL,

    preco_assinantes DECIMAL(10 , 2) NOT NULL,
    preco_nao_assinantes DECIMAL(10 , 2) NOT NULL,
    url_image VARCHAR(50)
);

CREATE TABLE galatas_signature_user (
    id INT PRIMARY KEY AUTO_INCREMENT,

    status ENUM ('ativo', 'inativo') NOT NULL,
    users_id INT NOT NULL,
    signature_id INT NOT NULL,

    UNIQUE (users_id, signature_id),
  
  
  FOREIGN KEY(users_id)
  	REFERENCES galatas_users(id),

  FOREIGN KEY(signature_id)
    REFERENCES galatas_signature(id)
);

CREATE TABLE galatas_scheduling (
    id INT PRIMARY KEY AUTO_INCREMENT,
    status ENUM ('confirmado', 'pendente', 'cancelado') NOT NULL,
    data_hora DATETIME NOT NULL,
    users_id INT NOT NULL,
    barber_id INT NOT NULL,
    service_id INT NOT NULL,
    
  FOREIGN KEY(users_id)
  	REFERENCES galatas_users(id),
  
  FOREIGN KEY(barber_id)
    REFERENCES galatas_barbers(id),
  
  FOREIGN KEY (service_id)
  	REFERENCES galatas_services(id)
);

